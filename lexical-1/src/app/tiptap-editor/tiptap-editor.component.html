<div class="tiptap-wrapper">
  <div class="row">
    <div class="col mt-1 ms-1">
      <div class="editor-pane">
        <h2>Tiptap Rich Text Editor</h2>

        <div class="toolbar" *ngIf="editor">
          <!-- Text Styles -->
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isActive('paragraph')"
            (click)="toggleParagraph()"
            title="Paragraph"
          >
            <i class="fas fa-paragraph"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isActive('heading', { level: 1 })"
            (click)="toggleHeading(1)"
            title="Heading 1"
          >
            <i class="fas fa-heading"></i> 1
          </button>
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isActive('heading', { level: 2 })"
            (click)="toggleHeading(2)"
            title="Heading 2"
          >
            <i class="fas fa-heading"></i> 2
          </button>
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isActive('heading', { level: 3 })"
            (click)="toggleHeading(3)"
            title="Heading 3"
          >
            <i class="fas fa-heading"></i> 3
          </button>

          <span class="toolbar-separator">|</span>

          <!-- Text Formatting -->
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isActive('bold')"
            (click)="toggleBold()"
            title="Bold"
          >
            <i class="fas fa-bold"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isActive('italic')"
            (click)="toggleItalic()"
            title="Italic"
          >
            <i class="fas fa-italic"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isActive('strike')"
            (click)="toggleStrike()"
            title="Strikethrough"
          >
            <i class="fas fa-strikethrough"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isActive('code')"
            (click)="toggleCode()"
            title="Inline Code"
          >
            <i class="fas fa-code"></i>
          </button>

          <span class="toolbar-separator">|</span>

          <!-- Font Family -->
          <select
            class="toolbar-select"
            [value]="currentFontFamily"
            (change)="setFontFamily($any($event.target).value)"
            title="Font Family"
          >
            <option *ngFor="let font of fontFamilies" [value]="font.value">
              {{ font.name }}
            </option>
          </select>

          <!-- Font Size -->
          <select
            class="toolbar-select"
            [value]="currentFontSize"
            (change)="setFontSize($any($event.target).value)"
            title="Font Size"
          >
            <option *ngFor="let size of fontSizes" [value]="size.value">
              {{ size.name }}
            </option>
          </select>

          <span class="toolbar-separator">|</span>

          <!-- Text Color -->
          <div class="color-picker-wrapper">
            <button
              type="button"
              class="toolbar-btn color-btn"
              title="Text Color"
            >
              <i class="fas fa-font"></i>
              <input
                type="color"
                class="color-input"
                [value]="currentTextColor"
                (input)="setTextColor($any($event.target).value)"
              />
            </button>
          </div>

          <!-- Highlight Color -->
          <div class="color-picker-wrapper">
            <button
              type="button"
              class="toolbar-btn color-btn"
              title="Highlight Color"
            >
              <i class="fas fa-highlighter"></i>
              <input
                type="color"
                class="color-input"
                [value]="
                  currentHighlightColor === 'transparent'
                    ? '#FFFF00'
                    : currentHighlightColor
                "
                (input)="setHighlightColor($any($event.target).value)"
              />
            </button>
          </div>

          <button
            type="button"
            class="toolbar-btn"
            (click)="setHighlightColor('transparent')"
            title="Remove Highlight"
          >
            <i class="fas fa-eraser"></i>
          </button>

          <span class="toolbar-separator">|</span>

          <!-- Lists and Blocks -->
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isActive('bulletList')"
            (click)="toggleBulletList()"
            title="Bullet List"
          >
            <i class="fas fa-list-ul"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isActive('orderedList')"
            (click)="toggleOrderedList()"
            title="Numbered List"
          >
            <i class="fas fa-list-ol"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isActive('blockquote')"
            (click)="toggleBlockquote()"
            title="Quote"
          >
            <i class="fas fa-quote-left"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isActive('codeBlock')"
            (click)="toggleCodeBlock()"
            title="Code Block"
          >
            <i class="fas fa-file-code"></i>
          </button>

          <span class="toolbar-separator">|</span>

          <!-- Alignment -->
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isAlignmentActive('left')"
            (click)="setTextAlign('left')"
            title="Align Left"
          >
            <i class="fas fa-align-left"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isAlignmentActive('center')"
            (click)="setTextAlign('center')"
            title="Align Center"
          >
            <i class="fas fa-align-center"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isAlignmentActive('right')"
            (click)="setTextAlign('right')"
            title="Align Right"
          >
            <i class="fas fa-align-right"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isAlignmentActive('justify')"
            (click)="setTextAlign('justify')"
            title="Justify"
          >
            <i class="fas fa-align-justify"></i>
          </button>

          <span class="toolbar-separator">|</span>

          <!-- [class.active]="isAlignmentActive('justify')" -->
          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isDirectionActive('ltr')"
            (click)="setTextDirection('ltr')"
            title="Justify"
          >
            <i class="fa-solid fa-arrow-right"></i>
          </button>

          <button
            type="button"
            class="toolbar-btn"
            [class.active]="isDirectionActive('rtl')"
            (click)="setTextDirection('rtl')"
            title="Justify"
          >
            <i class="fa-solid fa-arrow-left"></i>
          </button>

          <span class="toolbar-separator">|</span>

          <!-- Table -->
          <button
            type="button"
            class="toolbar-btn"
            (click)="insertTable()"
            title="Insert Table"
          >
            <i class="fas fa-table"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            (click)="addRowBefore()"
            title="Add Row Before"
          >
            <i class="fas fa-plus"></i> <i class="fas fa-arrows-alt-v"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            (click)="addColumnAfter()"
            title="Add Column After"
          >
            <i class="fas fa-plus"></i> <i class="fas fa-arrows-alt-h"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            (click)="deleteRow()"
            title="Delete Row"
          >
            <i class="fas fa-trash"></i> <i class="fas fa-arrows-alt-v"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            (click)="deleteColumn()"
            title="Delete Column"
          >
            <i class="fas fa-trash"></i> <i class="fas fa-arrows-alt-h"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            (click)="deleteTable()"
            title="Delete Table"
          >
            <i class="fas fa-trash-alt"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            (click)="mergeCells()"
            title="Merge Cells"
          >
            <i class="fas fa-compress-alt"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            (click)="splitCell()"
            title="Split Cell"
          >
            <i class="fas fa-expand-alt"></i>
          </button>

          <span class="toolbar-separator">|</span>

          <!-- Actions -->
          <button
            type="button"
            class="toolbar-btn"
            (click)="insertImage()"
            title="Insert Image"
          >
            <i class="fas fa-image"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            (click)="insertHorizontalRule()"
            title="Horizontal Rule"
          >
            <i class="fas fa-minus"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            (click)="insertHardBreak()"
            title="Line Break"
          >
            <i class="fas fa-level-down-alt"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            (click)="clearFormatting()"
            title="Clear Formatting"
          >
            <i class="fas fa-eraser"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            (click)="undo()"
            title="Undo"
          >
            <i class="fas fa-undo"></i>
          </button>
          <button
            type="button"
            class="toolbar-btn"
            (click)="redo()"
            title="Redo"
          >
            <i class="fas fa-redo"></i>
          </button>

          <span class="toolbar-separator">|</span>

          <!-- CS4 actions -->
          <button
            type="button"
            class="toolbar-btn"
            (click)="insertPlaceholderToken()"
            title="Insert Placeholder Token"
          >
            <i class="fas fa-tag"></i>
          </button>
        </div>
      </div>
    </div>

    <div class="col-12 mt-1 ms-1">
      <div class="editor-wrapper">
        <tiptap-editor
          *ngIf="editor"
          [editor]="editor"
          class="editor-host"
        ></tiptap-editor>

        <tiptap-bubble-menu
          *ngIf="editor"
          class="bubble-menu"
          [editor]="editor"
          [shouldShow]="bubbleMenuShouldShow"
          [tippyOptions]="{
            placement: 'top',
            duration: 100,
            animation: 'shift-away'
          }"
        >
          <button
            type="button"
            class="bubble-menu-btn"
            [class.active]="isActive('bold')"
            (click)="toggleBold()"
            aria-label="Bold"
          >
            <i class="fas fa-bold"></i>
          </button>
          <button
            type="button"
            class="bubble-menu-btn"
            [class.active]="isActive('italic')"
            (click)="toggleItalic()"
            aria-label="Italic"
          >
            <i class="fas fa-italic"></i>
          </button>
          <button
            type="button"
            class="bubble-menu-btn"
            [class.active]="isActive('strike')"
            (click)="toggleStrike()"
            aria-label="Strikethrough"
          >
            <i class="fas fa-strikethrough"></i>
          </button>
          <span class="bubble-menu-separator"></span>
          <button
            type="button"
            class="bubble-menu-btn"
            [class.active]="isActive('code')"
            (click)="toggleCode()"
            aria-label="Inline code"
          >
            <i class="fas fa-code"></i>
          </button>
          <button
            type="button"
            class="bubble-menu-btn"
            [class.active]="isActive('blockquote')"
            (click)="toggleBlockquote()"
            aria-label="Quote"
          >
            <i class="fas fa-quote-left"></i>
          </button>
          <span
            *ngIf="editor?.isActive('table')"
            class="bubble-menu-separator"
          ></span>
          <button
            *ngIf="editor?.isActive('table')"
            type="button"
            class="bubble-menu-btn"
            (click)="deleteTable()"
            aria-label="Delete table"
          >
            <i class="fas fa-table"></i>
            <i class="fas fa-trash-alt"></i>
          </button>
        </tiptap-bubble-menu>
      </div>
    </div>
  </div>

  <div class="html-pane">
    <h3>HTML Output</h3>
    <button type="button" class="copy-html-btn" (click)="copyHtmlOutput()">
      <i class="fas fa-copy"></i>
      Copy HTML
    </button>
    <div class="html-container">
      <pre><code>{{ htmlOutput }}</code></pre>
    </div>
  </div>
</div>
